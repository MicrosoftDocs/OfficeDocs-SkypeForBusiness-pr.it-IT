---
title: Implementare la qualità del servizio in Microsoft Teams
author: SerdarSoysal
ms.author: serdars
manager: Serdars
ms.topic: article
ms.service: msteams
ms.reviewer: vkorlep, siunies
audience: admin
description: Informazioni su come preparare la rete dell'organizzazione per la qualità del servizio (QoS) in Microsoft teams.
localization_priority: Normal
search.appverid: MET150
f1.keywords:
- CSH
ms.custom:
- ms.teamsadmincenter.meetingsettings.qos
- ms.teamsadmincenter.meetingsettings.network.qosmarkers
- seo-marvel-apr2020
ms.collection:
- M365-collaboration
appliesto:
- Microsoft Teams
ms.openlocfilehash: 6a83a18810268d3eb8317eb541f7eb06ff812c9c
ms.sourcegitcommit: 43d66693f6f08d4dcade0095bf613240031fec56
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/06/2020
ms.locfileid: "46582093"
---
# <a name="implement-quality-of-service-qos-in-microsoft-teams"></a><span data-ttu-id="3333b-103">Implementare la qualità del servizio (QoS) in Microsoft Teams</span><span class="sxs-lookup"><span data-stu-id="3333b-103">Implement Quality of Service (QoS) in Microsoft Teams</span></span>

<span data-ttu-id="3333b-104">La qualità del servizio (QoS) in Microsoft teams è un modo per consentire il traffico di rete in tempo reale sensibile ai ritardi di rete, ad esempio i flussi vocali o video, per "tagliare in linea" di fronte al traffico meno sensibile (come il download di una nuova app, dove un altro secondo da scaricare non è un problema).</span><span class="sxs-lookup"><span data-stu-id="3333b-104">Quality of Service (QoS) in Microsoft Teams is a way to allow real-time network traffic that is sensitive to network delays (for example, voice or video streams) to "cut in line" in front of traffic that is less sensitive (like downloading a new app, where an extra second to download isn't a big deal).</span></span> <span data-ttu-id="3333b-105">QoS identifica e contrassegna tutti i pacchetti in flussi in tempo reale (usando gli oggetti Criteri di gruppo di Windows e una caratteristica di routing denominata elenchi di controllo di accesso basati su porta, maggiori informazioni su queste sono di seguito) che consente quindi alla rete di fornire flussi di condivisione di voce, video e schermo una porzione dedicata della larghezza di banda della rete.</span><span class="sxs-lookup"><span data-stu-id="3333b-105">QoS identifies and marks all packets in real-time streams (using Windows Group Policy Objects and a routing feature called Port-based Access Control Lists, more about those is below) which then helps your network to give voice, video, and screen share streams a dedicated portion of network bandwidth.</span></span>

<span data-ttu-id="3333b-106">Se si sta supportando un numero elevato di utenti e si verificano i problemi descritti di seguito, è probabilmente necessario implementare QoS.</span><span class="sxs-lookup"><span data-stu-id="3333b-106">If you're supporting a large group of users and they're experiencing any of the problems described below, you probably need to implement QoS.</span></span> <span data-ttu-id="3333b-107">Una piccola azienda con pochi utenti potrebbe non avere bisogno di QoS, ma anche lì dovrebbe essere utile.</span><span class="sxs-lookup"><span data-stu-id="3333b-107">A small business with few users may not need QoS, but even there it should be helpful.</span></span>

<span data-ttu-id="3333b-108">Senza una qualche forma di QoS, è possibile che vengano visualizzati i problemi di qualità seguenti in voce e video:</span><span class="sxs-lookup"><span data-stu-id="3333b-108">Without some form of QoS, you might see the following quality issues in voice and video:</span></span>

- <span data-ttu-id="3333b-109">Jitter: i pacchetti multimediali che arrivano a tariffe diverse, che possono risultare in parole o sillabe mancanti nelle chiamate</span><span class="sxs-lookup"><span data-stu-id="3333b-109">Jitter – media packets arriving at different rates, which can result in missing words or syllables in calls</span></span>
- <span data-ttu-id="3333b-110">Perdita di pacchetti: pacchetti eliminati, che possono anche determinare una qualità vocale inferiore e un discorso difficile da comprendere</span><span class="sxs-lookup"><span data-stu-id="3333b-110">Packet loss – packets dropped, which can also result in lower voice quality and hard to understand speech</span></span>
- <span data-ttu-id="3333b-111">Ritardo di andata e ritorno (RTT)-pacchetti multimediali che impiegano molto tempo per raggiungere le proprie destinazioni, che causano ritardi evidenti tra due parti in una conversazione, facendo in modo che le persone possano comunicare tra loro</span><span class="sxs-lookup"><span data-stu-id="3333b-111">Delayed round trip time (RTT) – media packets taking a long time to reach their destinations, which results in noticeable delays between two parties in a conversation, causing people to talk over each other</span></span>

<span data-ttu-id="3333b-112">Il modo meno complesso per risolvere questi problemi consiste nell'aumentare le dimensioni delle connessioni dati, sia internamente che in Internet.</span><span class="sxs-lookup"><span data-stu-id="3333b-112">The least complex way to address these issues is to increase the size of the data connections, both internally and out to the internet.</span></span> <span data-ttu-id="3333b-113">Dato che spesso è proibitivo, QoS consente di gestire in modo più efficace le risorse disponibili invece di aggiungere larghezza di banda.</span><span class="sxs-lookup"><span data-stu-id="3333b-113">Since that is often cost-prohibitive, QoS provides a way to more effectively manage the resources you have instead of adding bandwidth.</span></span> <span data-ttu-id="3333b-114">Per risolvere i problemi di qualità, è consigliabile usare il QoS prima di tutto, quindi aggiungere la larghezza di banda solo se necessario.</span><span class="sxs-lookup"><span data-stu-id="3333b-114">To address quality issues, we recommend that you first use QoS, then add bandwidth only where necessary.</span></span>

<span data-ttu-id="3333b-115">Affinché la QoS sia efficace, le impostazioni QoS coerenti verranno applicate in tutta l'organizzazione, perché qualsiasi parte del percorso che non supporta le priorità QoS può degradare la qualità delle chiamate, del video e della condivisione dello schermo.</span><span class="sxs-lookup"><span data-stu-id="3333b-115">For QoS to be effective, you'll apply consistent QoS settings throughout your organization, because any part of the path that fails to support your QoS priorities can degrade the quality of calls, video, and screen sharing.</span></span> <span data-ttu-id="3333b-116">Questo include l'applicazione di impostazioni a tutti i PC o dispositivi utente, switch di rete, router a Internet e il servizio teams.</span><span class="sxs-lookup"><span data-stu-id="3333b-116">This includes applying settings to all user PCs or devices, network switches, routers to the internet, and the Teams service.</span></span>

<span data-ttu-id="3333b-117">_Figura 1. Relazione tra le reti di un'organizzazione e i servizi Microsoft 365 o Office 365_</span><span class="sxs-lookup"><span data-stu-id="3333b-117">_Figure 1. The relationship between an organization's networks and Microsoft 365 or Office 365 services_</span></span>

<span data-ttu-id="3333b-118">![Illustrazione della relazione tra reti e servizi](media/Qos-in-Teams-Image1.png "La relazione tra le reti di un'organizzazione e i servizi Microsoft 365 o Office 365: la rete locale e i dispositivi si connettono a una rete di interconnessione, che a sua volta si connette a Microsoft 365 o ai servizi di conferenza telefonica e audio di Office 365 cloud.")</span><span class="sxs-lookup"><span data-stu-id="3333b-118">![Illustration of the relationship between networks and services](media/Qos-in-Teams-Image1.png "The relationship between an organization's networks and Microsoft 365 or Office 365 services: on-premises network and devices connect with an interconnect network, which in turn connects with Microsoft 365 or Office 365 Cloud Voice and Audio Conferencing services.")</span></span>

## <a name="qos-implementation-checklist"></a><span data-ttu-id="3333b-119">Elenco di controllo di implementazione QoS</span><span class="sxs-lookup"><span data-stu-id="3333b-119">QoS implementation checklist</span></span>

<span data-ttu-id="3333b-120">Ad alto livello, eseguire le operazioni seguenti per implementare QoS:</span><span class="sxs-lookup"><span data-stu-id="3333b-120">At a high level, do the following to implement QoS:</span></span>

1. [<span data-ttu-id="3333b-121">Verificare che la rete sia pronta</span><span class="sxs-lookup"><span data-stu-id="3333b-121">Make sure your network is ready</span></span>](#make-sure-your-network-is-ready)

1. [<span data-ttu-id="3333b-122">Selezionare un metodo di implementazione QoS</span><span class="sxs-lookup"><span data-stu-id="3333b-122">Select a QoS implementation method</span></span>](#select-a-qos-implementation-method)

1. [<span data-ttu-id="3333b-123">Scegliere gli intervalli di porte iniziali per ogni tipo di elemento multimediale</span><span class="sxs-lookup"><span data-stu-id="3333b-123">Choose initial port ranges for each media type</span></span>](#choose-initial-port-ranges-for-each-media-type)

1. <span data-ttu-id="3333b-124">Implementare le impostazioni QoS:</span><span class="sxs-lookup"><span data-stu-id="3333b-124">Implement QoS settings:</span></span>
   1. <span data-ttu-id="3333b-125">Sui client che usano un oggetto Criteri di [gruppo per impostare intervalli e contrassegni della porta del dispositivo client](QoS-in-Teams-clients.md)</span><span class="sxs-lookup"><span data-stu-id="3333b-125">On clients using a GPO to [set client device port ranges and markings](QoS-in-Teams-clients.md)</span></span>
   2. <span data-ttu-id="3333b-126">Nei router (Vedi la documentazione del produttore) o in altri dispositivi di rete.</span><span class="sxs-lookup"><span data-stu-id="3333b-126">On routers (see the manufacturer documentation) or other network devices.</span></span> <span data-ttu-id="3333b-127">Può includere elenchi ACL basati su porta o semplicemente definire le code QoS e i contrassegni DSCP oppure tutti questi.</span><span class="sxs-lookup"><span data-stu-id="3333b-127">This may include port-based ACLs or simply defining the QoS queues and DSCP markings, or all of these.</span></span>

      > [!IMPORTANT]
      > <span data-ttu-id="3333b-128">È consigliabile implementare questi criteri QoS usando le porte di origine client e un indirizzo IP di origine e di destinazione "any".</span><span class="sxs-lookup"><span data-stu-id="3333b-128">We recommend implementing these QoS policies using the client source ports and a source and destination IP address of “any.”</span></span> <span data-ttu-id="3333b-129">In questo modo verrà intercettato il traffico multimediale in entrata e in uscita nella rete interna.</span><span class="sxs-lookup"><span data-stu-id="3333b-129">This will catch both incoming and outgoing media traffic on the internal network.</span></span>  

   3. [<span data-ttu-id="3333b-130">Impostare il modo in cui si vuole gestire il traffico multimediale per le riunioni Teams</span><span class="sxs-lookup"><span data-stu-id="3333b-130">Set how you want to handle media traffic for Teams meetings</span></span>](meeting-settings-in-teams.md#set-how-you-want-to-handle-real-time-media-traffic-for-teams-meetings)

5. <span data-ttu-id="3333b-131">[Convalidare l'implementazione QoS](#validate-your-qos-implementation) analizzando il traffico di team in rete.</span><span class="sxs-lookup"><span data-stu-id="3333b-131">[Validate your QoS implementation](#validate-your-qos-implementation) by analyzing Teams traffic on the network.</span></span>

<span data-ttu-id="3333b-132">Mentre ti prepari ad implementare QoS, tieni presente le linee guida seguenti:</span><span class="sxs-lookup"><span data-stu-id="3333b-132">As you prepare to implement QoS, keep the following guidelines in mind:</span></span>

- <span data-ttu-id="3333b-133">Il percorso più breve per Microsoft 365 è migliore</span><span class="sxs-lookup"><span data-stu-id="3333b-133">The shortest path to Microsoft 365 is best</span></span>
- <span data-ttu-id="3333b-134">Le porte di chiusura porteranno solo alla degradazione della qualità</span><span class="sxs-lookup"><span data-stu-id="3333b-134">Closing ports will only lead to quality degradation</span></span>
- <span data-ttu-id="3333b-135">Gli eventuali ostacoli in mezzo, ad esempio i proxy, non sono consigliati</span><span class="sxs-lookup"><span data-stu-id="3333b-135">Any obstacles in between, such as proxies, aren't recommended</span></span>
- <span data-ttu-id="3333b-136">Limitare il numero di hop:</span><span class="sxs-lookup"><span data-stu-id="3333b-136">Limit the number of hops:</span></span>
  - <span data-ttu-id="3333b-137">Client a Edge della rete da 3 a 5 hop</span><span class="sxs-lookup"><span data-stu-id="3333b-137">Client to network edge – 3 to 5 hops</span></span>
  - <span data-ttu-id="3333b-138">ISP a Microsoft Network Edge-3 hop</span><span class="sxs-lookup"><span data-stu-id="3333b-138">ISP to Microsoft network edge – 3 hops</span></span>
  - <span data-ttu-id="3333b-139">Microsoft Network Edge to Final Destination-irrilevante</span><span class="sxs-lookup"><span data-stu-id="3333b-139">Microsoft network edge to final destination – irrelevant</span></span>

<span data-ttu-id="3333b-140">Per informazioni sulla configurazione delle porte del firewall, vedere [URL e intervalli di indirizzi IP di Office 365](office-365-urls-ip-address-ranges.md).</span><span class="sxs-lookup"><span data-stu-id="3333b-140">For information about configuring firewall ports, go to [Office 365 URLs and IP ranges](office-365-urls-ip-address-ranges.md).</span></span>


## <a name="make-sure-your-network-is-ready"></a><span data-ttu-id="3333b-141">Verificare che la rete sia pronta</span><span class="sxs-lookup"><span data-stu-id="3333b-141">Make sure your network is ready</span></span>

<span data-ttu-id="3333b-142">Se si sta valutando un'implementazione QoS, è necessario che siano già stati determinati i requisiti di larghezza di banda e altri [requisiti di rete](prepare-network.md).</span><span class="sxs-lookup"><span data-stu-id="3333b-142">If you're considering a QoS implementation, you should already have determined your bandwidth requirements and other [network requirements](prepare-network.md).</span></span> 
  
<span data-ttu-id="3333b-143">La congestione del traffico in una rete avrà un impatto notevole sulla qualità dei contenuti multimediali.</span><span class="sxs-lookup"><span data-stu-id="3333b-143">Traffic congestion across a network will greatly impact media quality.</span></span> <span data-ttu-id="3333b-144">La mancanza di larghezza di banda comporta un peggioramento delle prestazioni e un'esperienza utente scadente.</span><span class="sxs-lookup"><span data-stu-id="3333b-144">A lack of bandwidth leads to performance degradation and a poor user experience.</span></span> <span data-ttu-id="3333b-145">Man mano che l'adozione e l'utilizzo di teams aumentano, USA Reporting, [analisi delle chiamate per utente](use-call-analytics-to-troubleshoot-poor-call-quality.md)e [dashboard qualità chiamata (Call Quality Dashboard)](turning-on-and-using-call-quality-dashboard.md) per identificare i problemi e quindi apportare modifiche usando QoS e aggiunte selettive per la larghezza di banda.</span><span class="sxs-lookup"><span data-stu-id="3333b-145">As Teams adoption and usage grows, use reporting, [per-user call analytics](use-call-analytics-to-troubleshoot-poor-call-quality.md), and [Call Quality Dashboard (CQD)](turning-on-and-using-call-quality-dashboard.md) to identify problems and then make adjustments using QoS and selective bandwidth additions.</span></span>

### <a name="vpn-considerations"></a><span data-ttu-id="3333b-146">Considerazioni su VPN</span><span class="sxs-lookup"><span data-stu-id="3333b-146">VPN considerations</span></span>

<span data-ttu-id="3333b-147">Il QoS funziona solo come previsto quando viene implementato in tutti i collegamenti tra i chiamanti.</span><span class="sxs-lookup"><span data-stu-id="3333b-147">QoS only works as expected when implemented on all links between callers.</span></span> <span data-ttu-id="3333b-148">Se si usa QoS in una rete interna e un utente accede da una posizione remota, è possibile dare la priorità solo all'interno della rete gestita interna.</span><span class="sxs-lookup"><span data-stu-id="3333b-148">If you use QoS on an internal network and a user signs in from a remote location, you can only prioritize within your internal, managed network.</span></span> <span data-ttu-id="3333b-149">Anche se le posizioni remote possono ricevere una connessione gestita implementando una rete privata virtuale (VPN), una VPN aggiunge in modo intrinseco il sovraccarico del pacchetto e crea ritardi nel traffico in tempo reale.</span><span class="sxs-lookup"><span data-stu-id="3333b-149">Although remote locations can receive a managed connection by implementing a virtual private network (VPN),  a VPN inherently adds packet overhead and creates delays in real-time traffic.</span></span> <span data-ttu-id="3333b-150">È consigliabile evitare di eseguire il traffico di comunicazioni in tempo reale tramite una rete VPN.</span><span class="sxs-lookup"><span data-stu-id="3333b-150">We  recommend that you avoid running real-time communications traffic over a VPN.</span></span>

<span data-ttu-id="3333b-151">In un'organizzazione globale con collegamenti gestiti che si estendono in continenti consigliamo vivamente QoS perché la larghezza di banda per tali collegamenti è limitata rispetto alla rete LAN.</span><span class="sxs-lookup"><span data-stu-id="3333b-151">In a global organization with managed links that span continents, we strongly recommend QoS because bandwidth for those links is limited in comparison to the LAN.</span></span>

## <a name="introduction-to-qos-queues"></a><span data-ttu-id="3333b-152">Introduzione alle code QoS</span><span class="sxs-lookup"><span data-stu-id="3333b-152">Introduction to QoS queues</span></span>

<span data-ttu-id="3333b-153">Per specificare il QoS, i dispositivi di rete devono avere la possibilità di classificare il traffico e devono essere in grado di distinguere la voce o il video da un altro traffico di rete.</span><span class="sxs-lookup"><span data-stu-id="3333b-153">To provide QoS, network devices must have a way to classify traffic and must be able to distinguish voice or video from other network traffic.</span></span>

<span data-ttu-id="3333b-154">Quando il traffico di rete entra in un router, il traffico viene inserito in una coda.</span><span class="sxs-lookup"><span data-stu-id="3333b-154">When network traffic enters a router, the traffic is placed into a queue.</span></span> <span data-ttu-id="3333b-155">Se un criterio QoS non è configurato, esiste una sola coda e tutti i dati vengono trattati come First-in, First-out con la stessa priorità.</span><span class="sxs-lookup"><span data-stu-id="3333b-155">If a QoS policy isn't configured, there is only one queue, and all data is treated as first-in, first-out with the same priority.</span></span> <span data-ttu-id="3333b-156">Questo significa che il traffico vocale (molto sensibile ai ritardi) potrebbe rimanere bloccato dietro il traffico in cui un ritardo di alcuni millisecondi aggiuntivi non è un problema.</span><span class="sxs-lookup"><span data-stu-id="3333b-156">That means voice traffic (which is very sensitive to delays) might get stuck behind traffic where a delay of a few extra milliseconds wouldn't be a problem.</span></span>

<span data-ttu-id="3333b-157">Quando implementi QoS, Definisci più code usando una delle varie funzionalità di gestione della congestione, ad esempio l'accodamento prioritario di Cisco e le caratteristiche di evasione [ponderata in base alle classi (CBWFQ)](https://www.cisco.com/en/US/docs/ios/12_0t/12_0t5/feature/guide/cbwfq.html#wp17641)e le funzionalità di prevenzione della congestione (ad esempio [WRED)](https://en.wikipedia.org/wiki/Weighted_random_early_detection).</span><span class="sxs-lookup"><span data-stu-id="3333b-157">When you implement QoS, you define multiple queues using one of several congestion management features (such as Cisco’s priority queuing and [Class-Based Weighted Fair Queueing (CBWFQ)](https://www.cisco.com/en/US/docs/ios/12_0t/12_0t5/feature/guide/cbwfq.html#wp17641)) and congestion avoidance features (such as [weighted random early detection (WRED)](https://en.wikipedia.org/wiki/Weighted_random_early_detection)).</span></span>

<span data-ttu-id="3333b-158">_Figura 2. Esempi di code QoS_</span><span class="sxs-lookup"><span data-stu-id="3333b-158">_Figure 2. Examples of QoS queues_</span></span>

<span data-ttu-id="3333b-159">![Illustrazione delle code QoS e della divisione larghezza di banda](media/Qos-in-Teams-Image2.png "La larghezza di banda disponibile totale è divisa tra più code, ad esempio audio, video e altro traffico, a cui sono state assegnate priorità diverse.")</span><span class="sxs-lookup"><span data-stu-id="3333b-159">![Illustration of QoS queues and bandwidth division](media/Qos-in-Teams-Image2.png "Total available bandwidth is divided among multiple queues—audio, video, and other traffic—that have been assigned different priorities.")</span></span>

<span data-ttu-id="3333b-160">Una semplice analogia consiste nel fatto che QoS crea una "corsia di carpooling" virtuale nella rete dati in modo che alcuni tipi di dati non incontrino mai o raramente un ritardo.</span><span class="sxs-lookup"><span data-stu-id="3333b-160">A simple analogy is that QoS creates virtual "carpool lanes" in your data network so some types of data never or rarely encounter a delay.</span></span> <span data-ttu-id="3333b-161">Dopo aver creato tali corsie, è possibile modificare le dimensioni relative e gestire in modo più efficace la larghezza di banda della connessione, garantendo comunque esperienze di livello aziendale per gli utenti dell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="3333b-161">Once you create those lanes, you can adjust their relative size and much more effectively manage the connection bandwidth you have, while still delivering business-grade experiences for your organization's users.</span></span>

## <a name="select-a-qos-implementation-method"></a><span data-ttu-id="3333b-162">Selezionare un metodo di implementazione QoS</span><span class="sxs-lookup"><span data-stu-id="3333b-162">Select a QoS implementation method</span></span>

<span data-ttu-id="3333b-163">Puoi implementare il QoS tramite tagging basato su porta, usando gli elenchi di controllo di accesso (ACL) nei router della rete.</span><span class="sxs-lookup"><span data-stu-id="3333b-163">You could implement QoS via port-based tagging, using Access Control Lists (ACLs) on your network's routers.</span></span> <span data-ttu-id="3333b-164">La codifica basata su porta è il metodo più affidabile perché funziona in ambienti Windows, Mac e Linux misti ed è la soluzione più semplice da implementare.</span><span class="sxs-lookup"><span data-stu-id="3333b-164">Port-based tagging is the most reliable method because it works in mixed Windows, Mac, and Linux environments and is the easiest to implement.</span></span> <span data-ttu-id="3333b-165">I client mobili non offrono un meccanismo per contrassegnare il traffico usando i valori DSCP, quindi richiedono questo metodo.</span><span class="sxs-lookup"><span data-stu-id="3333b-165">Mobile clients don't provide a mechanism to mark traffic by using DSCP values, so they will require this method.</span></span>  

<span data-ttu-id="3333b-166">Usando il contrassegno basato su porta, il router della rete esamina un pacchetto in arrivo e, se il pacchetto è arrivato usando una determinata porta o intervallo di porte, lo identifica come un determinato tipo di elemento multimediale e lo inserisce nella coda per quel tipo, aggiungendo un contrassegno di [DSCP](https://tools.ietf.org/html/rfc2474) predeterminato all'intestazione del pacchetto IP in modo che altri dispositivi possano riconoscere il tipo di traffico e assegnargli la priorità.</span><span class="sxs-lookup"><span data-stu-id="3333b-166">Using port-based tagging, your network's router examines an incoming packet, and if the packet arrived using a certain port or range of ports, it identifies it as a certain media type and puts it in the queue for that type, adding a predetermined [DSCP](https://tools.ietf.org/html/rfc2474) mark to the IP Packet header so other devices can recognize its traffic type and give it priority in their queue.</span></span>

<span data-ttu-id="3333b-167">Anche se questo funziona in tutte le piattaforme, contrassegna solo il traffico sul bordo WAN (non fino al computer client) e crea un sovraccarico di gestione.</span><span class="sxs-lookup"><span data-stu-id="3333b-167">Although this works across platforms, it only marks traffic at the WAN edge (not all the way to the client machine) and creates management overhead.</span></span> <span data-ttu-id="3333b-168">Devi fare riferimento alla documentazione fornita dal produttore del router per istruzioni sull'implementazione di questo metodo.</span><span class="sxs-lookup"><span data-stu-id="3333b-168">You should refer to the documentation provided by the router manufacturer for instructions on implementing this method.</span></span>

### <a name="insert-dscp-markers"></a><span data-ttu-id="3333b-169">Inserire indicatori DSCP</span><span class="sxs-lookup"><span data-stu-id="3333b-169">Insert DSCP markers</span></span>

<span data-ttu-id="3333b-170">Puoi anche implementare QoS usando un oggetto Criteri di gruppo per indirizzare i dispositivi client per inserire un indicatore DSCP nelle intestazioni di pacchetti IP che la identificano come particolare tipo di traffico, ad esempio Voice.</span><span class="sxs-lookup"><span data-stu-id="3333b-170">You could also implement QoS by using a Group Policy Object (GPO) to direct client devices to insert a DSCP marker in IP packet headers identifying it as particular type of traffic (for example, voice).</span></span> <span data-ttu-id="3333b-171">I router e altri dispositivi di rete possono essere configurati per riconoscerli e inserire il traffico in una coda separata con priorità più alta.</span><span class="sxs-lookup"><span data-stu-id="3333b-171">Routers and other network devices can be configured to recognize this and put the traffic in a separate, higher-priority queue.</span></span>

<span data-ttu-id="3333b-172">Anche se questo scenario è completamente valido, funzionerà solo per i client Windows collegati al dominio.</span><span class="sxs-lookup"><span data-stu-id="3333b-172">Although this scenario is entirely valid, it will only work for domain-joined Windows clients.</span></span> <span data-ttu-id="3333b-173">Qualsiasi dispositivo che non sia un client Windows collegato al dominio non verrà abilitato per il tagging DSCP.</span><span class="sxs-lookup"><span data-stu-id="3333b-173">Any device that isn't a domain-joined Windows client won't be enabled for DSCP tagging.</span></span> <span data-ttu-id="3333b-174">I client, ad esempio Mac OS, hanno tag hardcoded e verranno sempre contrassegnati come traffico.</span><span class="sxs-lookup"><span data-stu-id="3333b-174">Clients such as Mac OS have hard-coded tags and will always tag traffic.</span></span>

<span data-ttu-id="3333b-175">Sul lato positivo, il controllo della marcatura DSCP tramite GPO garantisce che tutti i computer aggiunti al dominio ricevano le stesse impostazioni e che solo un amministratore possa gestirli.</span><span class="sxs-lookup"><span data-stu-id="3333b-175">On the plus side, controlling the DSCP marking via GPO ensures that all domain-joined computers receive the same settings and that only an administrator can manage them.</span></span> <span data-ttu-id="3333b-176">I client che possono usare GPO verranno contrassegnati nel dispositivo di origine e i dispositivi di rete configurati possono riconoscere il flusso in tempo reale dal codice DSCP e assegnargli una priorità appropriata.</span><span class="sxs-lookup"><span data-stu-id="3333b-176">Clients that can use GPO will be tagged on the originating device, and then configured network devices can recognize the real-time stream by the DSCP code and give it an appropriate priority.</span></span>

### <a name="best-practice"></a><span data-ttu-id="3333b-177">Procedure consigliate</span><span class="sxs-lookup"><span data-stu-id="3333b-177">Best practice</span></span>

<span data-ttu-id="3333b-178">È consigliabile una combinazione di contrassegni DSCP presso gli elenchi ACL basati su porte e endpoint sui router, se possibile.</span><span class="sxs-lookup"><span data-stu-id="3333b-178">We recommend a combination of DSCP markings at the endpoint and port-based ACLs on routers, if possible.</span></span> <span data-ttu-id="3333b-179">L'uso di un oggetto Criteri di gruppo per catturare la maggior parte dei client e anche l'uso della codifica DSCP basata su porta garantisce che il dispositivo mobile, Mac e altri client ottengano comunque il trattamento QoS (almeno in parte).</span><span class="sxs-lookup"><span data-stu-id="3333b-179">Using a Group Policy object to catch the majority of clients, and also using port-based DSCP tagging will ensure that mobile, Mac, and other clients will still get QoS treatment (at least partially).</span></span>

<span data-ttu-id="3333b-180">I contrassegni DSCP possono essere paragonati ai francobolli che indicano agli addetti alle poste l'urgenza del parto e il modo migliore per ordinarlo per un parto rapido.</span><span class="sxs-lookup"><span data-stu-id="3333b-180">DSCP markings can be likened to postage stamps that indicate to postal workers how urgent the delivery is and how best to sort it for speedy delivery.</span></span> <span data-ttu-id="3333b-181">Dopo aver configurato la rete per dare priorità ai flussi multimediali in tempo reale, i pacchetti persi e i pacchetti tardivi dovrebbero diminuire notevolmente.</span><span class="sxs-lookup"><span data-stu-id="3333b-181">Once you've configured your network to give priority to real-time media streams, lost packets and late packets should diminish greatly.</span></span>

<span data-ttu-id="3333b-182">Una volta che tutti i dispositivi della rete usano le stesse classificazioni, marcature e priorità, è possibile ridurre o eliminare ritardi, pacchetti eliminati e jitter modificando le dimensioni degli intervalli di porte assegnati alle code usate per ogni tipo di traffico.</span><span class="sxs-lookup"><span data-stu-id="3333b-182">Once all devices in the network are using the same classifications, markings, and priorities, it's possible to reduce or eliminate delays, dropped packets, and jitter by changing the size of the port ranges assigned to the queues used for each traffic type.</span></span> <span data-ttu-id="3333b-183">Dal punto di vista teams, il passaggio di configurazione più importante è la classificazione e la marcatura dei pacchetti, ma per il QoS end-to-end è anche necessario allineare accuratamente la configurazione dell'applicazione con la configurazione di rete sottostante.</span><span class="sxs-lookup"><span data-stu-id="3333b-183">From the Teams perspective, the most important configuration step is the classification and marking of packets, but for end-to-end QoS to be successful you also need to carefully align the application's configuration with the underlying network configuration.</span></span> <span data-ttu-id="3333b-184">Una volta completata l'implementazione del QoS, la gestione continua è una questione di regolazione degli intervalli di porte assegnati a ogni tipo di traffico in base alle esigenze dell'organizzazione e all'uso effettivo.</span><span class="sxs-lookup"><span data-stu-id="3333b-184">Once QoS is fully implemented, ongoing management is a question of adjusting the port ranges assigned to each traffic type based on your organization's needs and actual usage.</span></span>

## <a name="choose-initial-port-ranges-for-each-media-type"></a><span data-ttu-id="3333b-185">Scegliere gli intervalli di porte iniziali per ogni tipo di elemento multimediale</span><span class="sxs-lookup"><span data-stu-id="3333b-185">Choose initial port ranges for each media type</span></span>

<span data-ttu-id="3333b-186">Il valore DSCP indica a una rete configurata in modo corrispondente quale priorità assegnare a un pacchetto o a un flusso, se il contrassegno DSCP viene assegnato dai client o dalla rete stessa in base alle impostazioni ACL.</span><span class="sxs-lookup"><span data-stu-id="3333b-186">The DSCP value tells a correspondingly configured network what priority to give a packet or stream, whether the DSCP mark is assigned by clients or the network itself based on ACL settings.</span></span> <span data-ttu-id="3333b-187">Ogni carico di lavoro multimediale ottiene un valore DSCP univoco (altri servizi potrebbero consentire ai carichi di lavoro di condividere un contrassegno DSCP, teams not) e un intervallo di porte definito e separato usato per ogni tipo di elemento multimediale.</span><span class="sxs-lookup"><span data-stu-id="3333b-187">Each media workload gets its own unique DSCP value (other services might allow workloads to share a DSCP marking, Teams does not) and a defined and separate port range used for each media type.</span></span> <span data-ttu-id="3333b-188">In altri ambienti potrebbe essere presente una strategia QoS esistente che consente di determinare la priorità dei carichi di lavoro di rete.</span><span class="sxs-lookup"><span data-stu-id="3333b-188">Other environments might have an existing QoS strategy in place, which will help you determine the priority of network workloads.</span></span>

<span data-ttu-id="3333b-189">La dimensione relativa degli intervalli di porta per i diversi carichi di lavoro in tempo reale in streaming imposta la percentuale di larghezza di banda disponibile totale dedicata a tale carico di lavoro.</span><span class="sxs-lookup"><span data-stu-id="3333b-189">The relative size of the port ranges for different real-time streaming workloads sets the proportion of the total available bandwidth dedicated to that workload.</span></span> <span data-ttu-id="3333b-190">Per tornare all'analogia postale precedente: una lettera con un timbro "Air mail" potrebbe essere scattata entro un'ora dall'aeroporto più vicino, mentre un piccolo pacchetto contrassegnato come "posta in blocco" può attendere un giorno prima di spostarsi su una serie di camion.</span><span class="sxs-lookup"><span data-stu-id="3333b-190">To return to our earlier postal analogy: a letter with an "Air Mail" stamp might get taken within an hour to the nearest airport, while a small package marked "Bulk Mail" mark can wait for a day before traveling over land on a series of trucks.</span></span>

<span data-ttu-id="3333b-191">_Intervalli di porte iniziali consigliati_</span><span class="sxs-lookup"><span data-stu-id="3333b-191">_Recommended initial port ranges_</span></span>

|<span data-ttu-id="3333b-192">Tipo di traffico multimediale</span><span class="sxs-lookup"><span data-stu-id="3333b-192">Media traffic type</span></span>| <span data-ttu-id="3333b-193">Intervallo di porte di origine client </span><span class="sxs-lookup"><span data-stu-id="3333b-193">Client source port range</span></span> |<span data-ttu-id="3333b-194">Protocollo</span><span class="sxs-lookup"><span data-stu-id="3333b-194">Protocol</span></span>|<span data-ttu-id="3333b-195">Valore DSCP</span><span class="sxs-lookup"><span data-stu-id="3333b-195">DSCP value</span></span>|<span data-ttu-id="3333b-196">Classe DSCP</span><span class="sxs-lookup"><span data-stu-id="3333b-196">DSCP class</span></span>|
|:--- |:--- |:--- |:--- |:--- |
|<span data-ttu-id="3333b-197">Audio</span><span class="sxs-lookup"><span data-stu-id="3333b-197">Audio</span></span>| <span data-ttu-id="3333b-198">50.000–50.019</span><span class="sxs-lookup"><span data-stu-id="3333b-198">50,000–50,019</span></span>|<span data-ttu-id="3333b-199">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="3333b-199">TCP/UDP</span></span>|<span data-ttu-id="3333b-200">46</span><span class="sxs-lookup"><span data-stu-id="3333b-200">46</span></span>|<span data-ttu-id="3333b-201">Expedited Forwarding (EF)</span><span class="sxs-lookup"><span data-stu-id="3333b-201">Expedited Forwarding (EF)</span></span>|
|<span data-ttu-id="3333b-202">Video</span><span class="sxs-lookup"><span data-stu-id="3333b-202">Video</span></span>| <span data-ttu-id="3333b-203">50.020–50.039</span><span class="sxs-lookup"><span data-stu-id="3333b-203">50,020–50,039</span></span>|<span data-ttu-id="3333b-204">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="3333b-204">TCP/UDP</span></span>|<span data-ttu-id="3333b-205">34</span><span class="sxs-lookup"><span data-stu-id="3333b-205">34</span></span>|<span data-ttu-id="3333b-206">Assured Forwarding (AF41)</span><span class="sxs-lookup"><span data-stu-id="3333b-206">Assured Forwarding (AF41)</span></span>|
|<span data-ttu-id="3333b-207">Condivisione di applicazioni/schermi</span><span class="sxs-lookup"><span data-stu-id="3333b-207">Application/Screen Sharing</span></span>| <span data-ttu-id="3333b-208">50.040–50.059</span><span class="sxs-lookup"><span data-stu-id="3333b-208">50,040–50,059</span></span>|<span data-ttu-id="3333b-209">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="3333b-209">TCP/UDP</span></span>|<span data-ttu-id="3333b-210">18</span><span class="sxs-lookup"><span data-stu-id="3333b-210">18</span></span>|<span data-ttu-id="3333b-211">Assured Forwarding (AF21)</span><span class="sxs-lookup"><span data-stu-id="3333b-211">Assured Forwarding (AF21)</span></span>|
||||||

<span data-ttu-id="3333b-212">Quando si usano queste impostazioni, tenere presente quanto segue:</span><span class="sxs-lookup"><span data-stu-id="3333b-212">Be aware of the following when you use these settings:</span></span>

- <span data-ttu-id="3333b-213">Se si prevede di implementare ExpressRoute in futuro e non è ancora stato implementato QoS, è consigliabile seguire le indicazioni in modo che i valori di DSCP siano uguali da mittente a destinatario.</span><span class="sxs-lookup"><span data-stu-id="3333b-213">If you plan to implement ExpressRoute in the future and haven't yet implemented QoS, we recommend that you follow the guidance so that DSCP values are the same from sender to receiver.</span></span>
- <span data-ttu-id="3333b-214">Tutti i client, inclusi i client mobili e i dispositivi teams, useranno questi intervalli di porte e saranno interessati da qualsiasi criterio DSCP implementato che usa questi intervalli di porta di origine.</span><span class="sxs-lookup"><span data-stu-id="3333b-214">All clients, including mobile clients and Teams devices, will use these port ranges and will be affected by any DSCP policy you implement that uses these source port ranges.</span></span> <span data-ttu-id="3333b-215">Gli unici client che continueranno a usare le porte dinamiche sono i client basati su browser (ovvero i client che consentono ai partecipanti di partecipare alle riunioni usando i loro browser).</span><span class="sxs-lookup"><span data-stu-id="3333b-215">The only clients that will continue to use dynamic ports are the browser-based clients (that is, those clients that let participants join meetings by using their browsers).</span></span>
- <span data-ttu-id="3333b-216">Anche se il client Mac usa gli stessi intervalli di porte, USA anche valori hardcoded per l'audio (EF) e il video (AF41).</span><span class="sxs-lookup"><span data-stu-id="3333b-216">Although the Mac client uses the same port ranges, it also uses hard-coded values for audio (EF) and video (AF41).</span></span> <span data-ttu-id="3333b-217">Questi valori non sono configurabili.</span><span class="sxs-lookup"><span data-stu-id="3333b-217">These values are not configurable.</span></span>
- <span data-ttu-id="3333b-218">Se in seguito è necessario regolare gli intervalli di porte per migliorare l'esperienza utente, gli intervalli di porta non possono sovrapporsi e devono essere adiacenti.</span><span class="sxs-lookup"><span data-stu-id="3333b-218">If you later need to adjust the port ranges to improve user experience, the port ranges can not overlap and should be adjacent to each other.</span></span>

## <a name="migrate-qos-to-teams"></a><span data-ttu-id="3333b-219">Eseguire la migrazione di QoS ai team</span><span class="sxs-lookup"><span data-stu-id="3333b-219">Migrate QoS to Teams</span></span>

<span data-ttu-id="3333b-220">Se hai distribuito in precedenza Skype for business online, inclusi i tag QoS e gli intervalli di porte e ora stai distribuendo teams, i team rispetteranno la configurazione esistente e useranno gli stessi intervalli di porte e le etichette come client Skype for business.</span><span class="sxs-lookup"><span data-stu-id="3333b-220">If you've previously deployed Skype for Business Online, including QoS tagging and port ranges, and are now deploying Teams, Teams will respect the existing configuration and will use the same port ranges and tagging as the Skype for Business client.</span></span> <span data-ttu-id="3333b-221">Nella maggior parte dei casi non sarà necessaria alcuna configurazione aggiuntiva.</span><span class="sxs-lookup"><span data-stu-id="3333b-221">In most cases, no additional configuration will be needed.</span></span>

> [!NOTE]
> <span data-ttu-id="3333b-222">Se si usa la codifica QoS nome applicazione tramite criteri di gruppo, è necessario aggiungere Teams.exe come nome dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="3333b-222">If you're using Application Name QoS tagging via Group Policy, you must add Teams.exe as the application name.</span></span>


## <a name="managing-source-ports-in-the-teams-admin-center"></a><span data-ttu-id="3333b-223">Gestione delle porte di origine nell'interfaccia di amministrazione di Teams</span><span class="sxs-lookup"><span data-stu-id="3333b-223">Managing source ports in the Teams admin center</span></span>

<span data-ttu-id="3333b-224">In teams le porte di origine QoS usate dai diversi carichi di lavoro devono essere gestite in modo attivo e modificate in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="3333b-224">In Teams, QoS source ports used by the different workloads should be actively managed, and adjusted as necessary.</span></span> <span data-ttu-id="3333b-225">Facendo riferimento alla tabella in [Scegli intervalli di porte iniziali per ogni tipo](#choose-initial-port-ranges-for-each-media-type)di elemento multimediale, gli intervalli di porta sono regolabili, ma i contrassegni di DSCP non sono configurabili.</span><span class="sxs-lookup"><span data-stu-id="3333b-225">Referring to the table in [Choose initial port ranges for each media type](#choose-initial-port-ranges-for-each-media-type), the port ranges are adjustable, but the DSCP markings are not configurable.</span></span> <span data-ttu-id="3333b-226">Dopo aver implementato queste impostazioni, è possibile che siano necessarie più o meno porte per un tipo di elemento multimediale specifico.</span><span class="sxs-lookup"><span data-stu-id="3333b-226">Once you have implemented these settings, you may find that more or fewer ports are needed for a given media type.</span></span> <span data-ttu-id="3333b-227">Le [analisi delle chiamate per utente](use-call-analytics-to-troubleshoot-poor-call-quality.md) e il [dashboard di qualità delle chiamate (Call Quality Dashboard)](turning-on-and-using-call-quality-dashboard.md) devono essere usate per prendere una decisione per regolare gli intervalli di porte dopo l'implementazione di teams e periodicamente come le esigenze cambiano.</span><span class="sxs-lookup"><span data-stu-id="3333b-227">[Per-user call analytics](use-call-analytics-to-troubleshoot-poor-call-quality.md) and [Call Quality Dashboard (CQD)](turning-on-and-using-call-quality-dashboard.md) should be used in making a decision to adjust port ranges after Teams has been implemented, and periodically as needs change.</span></span>

> [!NOTE]
> <span data-ttu-id="3333b-228">Se la funzionalità QoS è già stata configurata in base a intervalli di porta di origine e contrassegni DSCP per Skype for business online, la stessa configurazione verrà applicata ai team e non saranno necessarie ulteriori modifiche al client o alla rete, ma potrebbe essere necessario [impostare gli intervalli usati in teams](meeting-settings-in-teams.md#set-how-you-want-to-handle-real-time-media-traffic-for-teams-meetings) in modo che corrispondano a quelli configurati per Skype for business online.</span><span class="sxs-lookup"><span data-stu-id="3333b-228">If you've already configured QoS based on source port ranges and DSCP markings for Skype for Business Online, the same configuration will apply to Teams and no further client or network changes to the mapping will be required, though you may have to [set the ranges used in Teams](meeting-settings-in-teams.md#set-how-you-want-to-handle-real-time-media-traffic-for-teams-meetings) to match what was configured for Skype for Business Online.</span></span>

<span data-ttu-id="3333b-229">Se hai distribuito in precedenza Skype for Business Server in locale, potrebbe essere necessario riesaminare i criteri QoS e regolarli in modo che corrispondano alle impostazioni dell'intervallo di porte che hai verificato per consentire un'esperienza utente di qualità per i team.</span><span class="sxs-lookup"><span data-stu-id="3333b-229">If you’ve previously deployed Skype for Business Server on-premises, you may need to re-examine your QoS policies and adjust them to match port range settings you've verified provide a quality user experience for Teams.</span></span>

## <a name="validate-your-qos-implementation"></a><span data-ttu-id="3333b-230">Convalidare l'implementazione QoS</span><span class="sxs-lookup"><span data-stu-id="3333b-230">Validate your QoS implementation</span></span>

<span data-ttu-id="3333b-231">Affinché il QoS sia efficace, il valore DSCP impostato dall'oggetto Criteri di gruppo deve essere presente in entrambe le estremità di una chiamata.</span><span class="sxs-lookup"><span data-stu-id="3333b-231">For QoS to be effective, the DSCP value set by the Group Policy object needs to be present at both ends of a call.</span></span> <span data-ttu-id="3333b-232">Analizzando il traffico generato dal client teams, è possibile verificare che il valore DSCP non venga modificato o rimosso quando il traffico del carico di lavoro teams passa attraverso la rete.</span><span class="sxs-lookup"><span data-stu-id="3333b-232">By analyzing the traffic generated by the Teams client, you can verify that the DSCP value isn’t changed or stripped out when the Teams workload traffic moves through the network.</span></span>

<span data-ttu-id="3333b-233">È preferibile acquisire il traffico nel punto di uscita della rete.</span><span class="sxs-lookup"><span data-stu-id="3333b-233">Preferably, you capture traffic at the network egress point.</span></span> <span data-ttu-id="3333b-234">È possibile usare il mirroring della porta su uno switch o un router per aiutarlo.</span><span class="sxs-lookup"><span data-stu-id="3333b-234">You can use port mirroring on a switch or router to help with this.</span></span>


## <a name="related-topics"></a><span data-ttu-id="3333b-235">Argomenti correlati</span><span class="sxs-lookup"><span data-stu-id="3333b-235">Related topics</span></span>

[<span data-ttu-id="3333b-236">Video: pianificazione della rete</span><span class="sxs-lookup"><span data-stu-id="3333b-236">Video: Network Planning</span></span>](https://aka.ms/teams-networking)

[<span data-ttu-id="3333b-237">Preparare la rete dell'organizzazione per Microsoft Teams</span><span class="sxs-lookup"><span data-stu-id="3333b-237">Prepare your organization's network for Microsoft Teams</span></span>](prepare-network.md)

[<span data-ttu-id="3333b-238">Implementare QoS nel client Teams</span><span class="sxs-lookup"><span data-stu-id="3333b-238">Implement QoS in the Teams client</span></span>](QoS-in-Teams-clients.md)
